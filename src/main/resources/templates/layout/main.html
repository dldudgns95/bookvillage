<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{/layout/header::head('책빌리지')}"></head>

<script th:src="@{/js/main.js}"></script>

<style>
  .main_notice_list {
    width: 100%;
    display: flex;
    margin: 10px;
    justify-content: center;
  }

  .main_notice_list_box1,
  .main_notice_list_box2 {
    font-size: 15px;
    width: calc(50% - 10px);
    height: 300px;
    box-sizing: border-box;
    justify-content: space-between;
    padding: 10px;
  }

  .main_notice_list_box1 {
  }

  .notice_list {
    margin: 10px;
    justify-content: center;
  }

  .swiper-slide-box {
    width: 100%;
  }

  .detail_img {
    display: flex;
    flex: 3;
    left: 20px;
    margin-right: 20px;
  }

  .search_inline {
    display: inline-block;
  }

.owl-item img {
  width: 200px; 
  height: 270px;
  object-fit: contain;
}
.newBookList{
  margin: 10px;
  padding: 10px;
}
.sliserImg{
  margin-bottom: 5px;
}

  
</style>

<body>
  
  <div th:replace="~{/layout/header::header}"></div>
  
  <div class="main_wrap">
    
    <!-- Slider main container -->
    <div class="swiper first">
      <!-- Additional required wrapper -->

      <div class="swiper-wrapper">
        <!-- Slides -->
        <div class="swiper-slide">
          <img class="main1" th:src="@{'/image/long_banner2.png'}" alt="Banner Image">
        </div>
        <div class="swiper-slide">
          <img class="main1" th:src="@{'/image/long_banner3.png'}" alt="Banner Image">
        </div>
        <div class="swiper-slide">
          <img class="main1" th:src="@{'/image/long_banner1.png'}" alt="Banner Image">
        </div>
      </div>
      
      <!-- If we need pagination -->
      <div class="swiper-pagination"></div>
    
      <!-- If we need navigation buttons -->
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>

    </div>

    
    <!-- 슬라이드 밑 박스 2개 -->

    <div class="main_notice_list">
      
    <!-- 첫 번째 박스 - 공지사항 목록 -->
      <div class="main_notice_list_box1">

        <div class="table-responsive notice_list">
          <h3 class="title2">공지사항</h3>
          
          <table  class="table align-middle">
            <thead>
              <tr>
                <td>순번</td>
                <td>제목</td>
                <td>작성날자</td>
              </tr>              
            </thead>
            <tbody id="ntBoby"></tbody>
          </table>
          
        </div>


      </div>
  
      <!-- 두 번째 박스 FAQ 목록-->
      <div class="main_notice_list_box2">
        
        <div class="table-responsive notice_list">
            <h3 class="title2">FAQ</h3>
            
            <table class="table align-middle">
                <thead>
                    <tr>
                        <td>순번</td>
                        <td>제목</td>
                        <td>내용</td>
                    </tr>
                </thead>
                <tbody id="faqTableBody"></tbody>
            </table>
        </div>
        
      </div>
      
      
    </div>
    
   <!-- 신간도서 슬라이드  th:each="bookDetail:${bookDetailList}" -->

   <div class="newBookList"> 
    <div class="title2">신간 도서 목록</div>
      
      <div class="carousel-container">
        <div class="owl-carousel" id="bookCarousel">
      </div>
    </div> 
   </div>
  
  <script>
    
    // 보존,,,
   $(document).ready(function() {
    // Owl Carousel 초기화
    $('.owl-carousel').owlCarousel({
      items: 5, // 한 번에 표시되는 아이템 수
      loop: true,
      margin: 50,
      autoplay: true,
      autoplayTimeout: 2000,
      autoplayHoverPause: true,
    });
  });    
  
  
  
  //////// 이게 돌고 있따!!!!!!!
  
   $(document).ready(function () {
  var carousel = $("#bookCarousel");

  $.ajax({
    type: 'GET',
    url: '/main/bookImageList.do',
    contentType: 'application/json',
    success: function (response) {
      response.book.forEach(function (book) {
        var truncatedTitle = book.title.substring(0, 20) + (book.title.length > 20 ? '...' : '');
        var statusText = book.status === 1 ? '대출 가능' : '대출 중';

        // 이미지를 동적으로 추가
        carousel.owlCarousel('add', `<div><a href="/book/search/detail?isbn=${book.isbn}"><img class="sliserImg" src="${book.cover}" alt="${book.title}">${truncatedTitle}<br>${statusText}</a></div>`);

          console.log('isbn '+ book.isbn )

        // 추가한 아이템에 클릭 이벤트 등록
        carousel.find('.owl-item').on('click', function () {
          // 클릭된 아이템의 ISBN을 가져와서 상세 페이지로 이동
          var isbn = $(this).find('img').attr('data-isbn');
          window.location.href = '/book/search/detail?isbn=' +  book.isbn;
        });
      });
    },
    error: function (error) {
      console.log('Error fetching book data: ' + error);
    }
  });
});


</script>

  <div th:replace="~{/layout/footer::footer}"></div>
  
</body>
</html>